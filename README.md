# 🎬 视频处理工具集

> 专业的视频处理工具套件，集音频提取和字幕重命名于一体

## ✨ 功能特色

### 🎵 音频提取
- **高速无损提取**：直接复制音频流，速度提升5-10倍
- **智能音频优化**：自动检测并修复伪立体声音频
- **格式兼容性**：自动处理格式转换，确保最佳兼容性
- **批量处理**：支持整个文件夹的批量处理
- **多线程加速**：可设置1-32个并发线程
- **实时进度**：详细的处理进度和统计信息

### 📝 字幕重命名
- **智能匹配**：基于剧集编号和文件名相似度的智能匹配
- **多格式支持**：支持S01E02、E02、第02集等多种命名格式
- **时长验证**：可选的视频时长匹配验证（需FFprobe）
- **批量操作**：支持大量字幕文件的批量重命名
- **安全撤销**：完整的操作日志和一键撤销功能

## 🚀 快速开始

### 系统要求
- Windows 7/8/10/11 (64位)
- Python 3.8+ （开发环境）

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python main.py
```

## 📁 项目结构

```
refactor_project/
├── 📄 main.py                     # 主程序入口
├── 📄 requirements.txt            # 依赖包列表
├── 📄 README.md                   # 项目说明
│
├── 📁 src/                        # 源代码目录
│   ├── main_window.py             # 主窗口实现
│   └── __init__.py
│
├── 📁 modules/                    # 功能模块
│   ├── common/                    # 通用模块
│   │   ├── activation.py          # 激活管理
│   │   ├── utils.py               # 工具函数
│   │   └── __init__.py
│   ├── audio_extractor/           # 音频提取模块
│   │   ├── extractor.py           # 音频提取器
│   │   └── __init__.py
│   ├── subtitle_renamer/          # 字幕重命名模块
│   │   ├── renamer.py             # 字幕重命名器
│   │   └── __init__.py
│   └── __init__.py
│
├── 📁 ui/                         # 用户界面
│   ├── components/                # UI组件
│   │   ├── activation_dialog.py   # 激活对话框
│   │   └── __init__.py
│   ├── styles/                    # 样式文件
│   │   ├── app_style.py           # 应用样式
│   │   └── __init__.py
│   └── __init__.py
│
├── 📁 config/                     # 配置文件
│   ├── app_config.py              # 应用配置
│   └── __init__.py
│
├── 📁 resources/                  # 资源文件
│   └── images/                    # 图像资源
│       ├── video_audio_extractor.png
│       └── ...
│
├── 📁 bin/                        # 可执行文件
│   ├── ffmpeg.exe                 # 音视频处理引擎
│   └── ffprobe.exe                # 媒体信息探测
│
├── 📁 docs/                       # 项目文档
├── 📁 tests/                      # 测试文件
└── 📁 config/                     # 配置目录
```

## 🎯 使用指南

### 音频提取功能

1. **选择素材文件夹**：包含视频文件的文件夹
2. **配置输出设置**：
   - 选择导出文件夹，或勾选"导出到原文件夹"
   - 设置是否保持原始目录结构
   - 选择是否跳过已存在的文件
3. **调整处理参数**：设置并发线程数（建议为CPU核心数的1-2倍）
4. **开始提取**：点击"开始提取"按钮
5. **监控进度**：查看实时进度和处理日志

#### 支持的视频格式
- MP4, AVI, MKV, MOV, WMV, FLV
- WebM, M4V, 3GP, MTS, M2TS, TS

#### 输出音频格式
- 根据源视频音频编码自动确定
- 支持 AAC, MP3, AC3, FLAC, OGG 等
- 自动转码不兼容格式为MP3

### 字幕重命名功能

1. **选择素材库文件夹**：包含视频和字幕文件的文件夹
2. **可选启用时长匹配**：提高匹配准确性（需要FFprobe）
3. **扫描文件**：点击"扫描并生成重命名计划"
4. **预览计划**：查看匹配结果和重命名计划
5. **执行重命名**：确认无误后点击"开始重命名"
6. **撤销操作**：如有错误可一键撤销

#### 支持的字幕格式
- SRT, ASS, SSA, VTT, SUB

#### 智能匹配规则
- **剧集编号匹配**：S01E02, E02, 第02集等格式
- **文件名相似度**：基于模糊匹配算法
- **同目录优先**：优先匹配同目录下的文件
- **时长验证**：可选的视频时长匹配

## 🔧 技术特性

### 音频提取技术
- **伪立体声检测**：自动检测并修复只有单声道的"假"立体声
- **流复制技术**：无转码直接复制，保持原始质量
- **智能转码**：自动处理不兼容格式和超大文件
- **多线程处理**：充分利用多核CPU性能

### 字幕匹配算法
- **多重匹配策略**：编号匹配 + 模糊匹配 + 时长验证
- **容错机制**：支持各种命名规范和格式变体
- **冲突处理**：智能避免文件名冲突
- **操作日志**：完整记录所有操作，支持精确撤销

## 🛡️ 安全特性

- **激活系统**：基于手机号的安全激活机制
- **权限管理**：智能处理文件权限问题
- **数据保护**：操作前自动备份，确保数据安全
- **错误恢复**：完善的错误处理和恢复机制

## 📊 性能优化

- **内存优化**：流式处理，支持处理大文件
- **IO优化**：异步文件操作，提升处理速度
- **缓存机制**：智能缓存文件信息，避免重复扫描
- **进度优化**：精确的进度计算和预估算法

## 🎨 界面设计

- **现代化设计**：简洁美观的用户界面
- **响应式布局**：适配不同屏幕尺寸
- **主题支持**：支持浅色和深色主题
- **国际化**：中文界面，符合本土化需求

## 📋 开发说明

### 架构设计
- **模块化设计**：功能模块独立，便于维护
- **MVC架构**：清晰的业务逻辑分离
- **事件驱动**：基于Qt信号槽的事件系统
- **插件化**：易于扩展新功能

### 代码规范
- **类型注解**：完整的Python类型注解
- **文档字符串**：详细的函数和类文档
- **错误处理**：完善的异常处理机制
- **单元测试**：全面的测试覆盖

## 📄 许可证

本项目采用自定义许可证，详见项目仓库。

---

**🎉 享受高效的视频处理体验！**




